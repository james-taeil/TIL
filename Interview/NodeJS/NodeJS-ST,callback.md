# 왜 nodejs 는 single-threaded 인가요?
## 알기전에
single-thread의 이야기가 나오면 기초적으로 알고가야 하는 개념 두개가 있다.

### 프로세스
프로세스란 컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램을 말한다. 
다시 말해 운영체제에서 할당하는 작업의 단위이다. 
노드도 하나의 프로그램이기 때문에 실행된다면 하나의 독립된 프로세스로서 사용할 리소스를 할당 받게 된다.


### 스레드
이 프로세스 안에서 실행되는 흐름의 단위를 스레드라고 한다. 프로세스는 여러 개의 스레드를 가질 수 있으며 이 스레드 들은 프로세스의 자원을 공유한다. 우리가 흔히 컴퓨터 사양을 말할 때 2코어 4스레드, 4코어 8스레드 라고 말하는데, 이때 말하는 스레드와 프로세스를 말할 때 스레드는 조금 다르다. 이 부분에 대해 공부한 것도 조만간 정리해서 올려야겠다.


## 그럼 NodeJS는 single-thread?
일단 답은 NO
node도 여러개의 thread를 가지고 있다. 하지만 JS는 실행하는 스레드는 하나여서 node를 single-thread라고 한다.
그리고 single-thread가 event-loop 이다.

### Event Loop
![](https://cdn.discordapp.com/attachments/900659683822555199/900659826739265536/unknown.png)

&nbsp;
node는 이벤트 기반의 플랫폼이기 때문에 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식으로 작동한다. 이 말은 곧 node 에서 일어나는 모든 처리는 일련의 콜백을 처리하는 것과 같다고 할 수 있다. Nods.js는 v8이라는 자바스크립트 엔진과 비동기 작업을 처리하는 libuv 라는 라이브러리로 이뤄져있다.

# nodejs에서 callback을 설명해 보세요.
callback이란 내가 필요할 때, 다시 불러서 사용할 수 있도록 만든 기능을 말한다.
다시말해, 어떤 일을 객체에게 작동시키고 그 일이 끝날때까지 기다리는 것이 아니라, 그 객체가 callback을 부를 때 까지 내 할일 하다가 부르면 작동하는 기능이다.

이를 Non-Block이고, 비동기방식(Asynchronous) 방식의 함수로 쓰인다.

## Non-Block / Asynchronous
Blocking 방식은 동기와 같은 말이다. 파일 하나를 import 하는 코드를 작성했다고 가정하면, 파일 하나가 import 되기 전까지 다음 코드는 작동이 안한다. 만약 다음 코드를 작동해야 하는데, 그 전에 오류가 났다고 하면, 프로그램은 다운 될 것 이다.

하지만 Non-Blocking은 파일은 파일대로 읽고, 다음 실행할 코드는 코드대로 작동되는 장점으로, 코드가 많고 작동 될 코드가 많을 때, 효율적이라고 생각한다. 하지만 비동기가 무조건적으로 좋은 건 아니다.

Node.js에서 JavaScript 실행이 싱글 스레드이므로 동시성은 다른 작업이 완료된 후에 JavaScript 콜백 함수를 실행하는 이벤트 루프의 능력을 의미합니다. 동시에 실행되어야 하는 모든 코드는 I/O 등의 JavaScript가 아닌 작업이 일어나는 동안 이벤트 루프가 계속 실행될 수 있도록 해야 합니다.

예시로 웹서버로의 요청이 완료되기까지 50ms가 걸리고 50ms 중 45ms는 비동기로 실행될 수 있는 데이터베이스 I/O인 상황을 생각해 보겠습니다. 논블로킹 비동기 작업을 사용하면 요청마다 45ms는 다른 요청을 처리할 수 있게 됩니다. 이는 블로킹 메서드 대신 논블로킹 메서드를 사용함으로써 확연히 다른 성능 차이가 납니다.